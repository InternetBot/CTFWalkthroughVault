# Web Exploitation Walkthrough

Once you click on the website, you should see a controller that looks like this:

![Controller image](/Web%20Exploitation/assets/controller.png)

There isn't much to do on the page except click the buttons on the controller. Open the inspect mode:

- **macOS**: `Cmd + Option + I`  
- **Windows**: `Ctrl + Shift + I`

Once the inspect mode is opened, inspect the header. You should see a JavaScript script that provides an overview of what's going on:

![Script.js image](/Web%20Exploitation/assets/script1.png)

## Analyzing the Script

Once you analyze the script, you'll realize it's a little bit different from Game_Controller. The `||` statement is missing:

```javascript
if (press === '1001149811411797101989897') {
    // Flag logic
}
```

This means that the flag is hidden somewhere else or a clue to the controller combination is missing. We have the function:

```javascript
if (data.length === 10) {
    superagent.get('/flag_2').accept('json').query({
        data: data
        //flag logic
```

There is not much we can do with the scripts. No clues here to help us.

## Analyzing the Network

In most CTFs, when the flag is not in the script, there is always a slight chance it's located somewhere under the Network tab.

![network image](/Web%20Exploitation/assets/network.png)

Under the network tab, we can see the list of all resources that were loaded by the webpage. `level_2` seems to be a good place to stat exploring. You may wonder why the answer is simple: `jquery-3.3.1.slim.min.js` and `superagent.min.js` are just java secript files loaded when i clicked on the website. `semantic.min.css`, `icons.woff2` and `S6uyw4BMUTPHjx4WiWtFCc.woff2` are just css and font files. Sometimes the flag might be located in any of those you can never tell.

## Analyzing level 2 Header

Upon clicking on the level_2 header, everything seems normal; nothing out of the ordinary.

![header image](/Web%20Exploitation/assets/header.png)

But when we open on the `response header`. We can see something interesting. 

![request image](/Web%20Exploitation/assets/request.png)

If you look over the X: Sequence, we see something similar to what was present in Game_Controller, which is the Unicode `117116108979710010110011497` now decrypting this unicode would lead to the perfect control combination to unlock the flag

## Reverse Engineering the Cheat Code

To decode this, we need to reverse-engineer it using the Unicode values of the key inputs. Remember the unicode was given to us in the response header

| Button | Unicode |
|--------|---------|
| u      | 85      |
| l      | 108     |
| r      | 114     |
| d      | 100     |
| e      | 101     |
| t      | 116     |
| a      | 97      |
| b      | 98      |

Using this mapping, you can decode the Unicode string to find the correct button combination.


## Conclusion
With this approach, you can systematically decode the cheat code required to unlock the flag. Happy Hacking, fellow Hacker!